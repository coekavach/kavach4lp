<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>e-Operating Manual for Loco Pilots</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.415.0/lucide.min.js"></script>
    <style>
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .tab.active {
            background-color: #f0f9ff;
            border-bottom: 2px solid #1d4ed8;
            color: #1d4ed8;
        }
        .footer-text {
            position: fixed;
            bottom: 0;
            right: 0;
            margin: 16px;
            font-style: italic;
            color: grey;
        }
        .dropdown {
            position: relative;
            display: inline-block;
        }
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
        }
        .dropdown:hover .dropdown-content {
            display: block;
        }
        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }
        .dropdown-content a:hover {
            background-color: #f1f1f1;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-4">
        <h1 class="text-4xl font-bold mb-12 text-center mx-auto text-blue-700">
            e-Operating Manual for Loco Pilots
            <br>
            <span class="text-3xl italic text-blue-700 font-normal">
                Kavach Spec Ver 3.2
            </span>
        </h1>
        <div class="mb-8 flex justify-center items-center">
            <input type="text" id="searchInput" placeholder="Search..." class="border-2 border-blue-500 rounded-lg p-2 text-lg shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full max-w-md">
            <i data-lucide="search" class="text-gray-500 ml-3 text-lg"></i>
        </div>
        <div id="searchResults" class="bg-white shadow-md rounded p-4 hidden">
            <h2 class="text-xl font-semibold mb-4">Search Results</h2>
            <div id="resultsContent"></div>
        </div>
        <div id="mainContent">
            <div class="mb-4">
                <div class="flex flex-wrap border-b">
                    <button class="tab py-2 px-4" data-tab="overview">Overview</button>
                    <button class="tab py-2 px-4" data-tab="abbreviations">Abbreviations</button>
                    <div class="dropdown">
                        <button class="tab py-2 px-4" data-tab="operatingModes">Kavach Operation</button>
                        <div class="dropdown-content">
                            <a href="#" class="tab" data-tab="operatingModes">Operating Modes</a>
                            <a href="#" class="tab" data-tab="procedures">Key Procedures</a>
                            <a href="#" class="tab" data-tab="dosAndDonts">DOs and DON'Ts</a>
                        </div>
                    </div>
                    <button class="tab py-2 px-4" data-tab="quiz">Take Quiz</button>
                </div>
            </div>
            <div class="bg-white shadow-md rounded p-4">
                <div id="overview" class="tab-content active">
                    <h2 class="text-xl font-semibold mb-4">Introduction To Kavach</h2>
                    <p>Kavach is India's indigenous Automatic Train Protection (ATP) system. Originally called the Train Collision Avoidance System (TCAS), it has been developed in India to boost train safety. Kavach is designed to help loco pilots, by providing them with important information and automatic controls. Kavach has been adopted as our National Automatic Train Protection (ATP) System in the year 2020.Kavach offers several key safety features. It constantly monitors train speed, preventing trains from going too fast or running past red signals. It also controls speed on loop lines. The system shows upcoming signal status in the LP-OCIP and automatically blows the train whistle(horn) at railway crossings. </p>
                    <br>
                    <br>
                    <br>
                    <h2 class="text-xl font-semibold mb-4">Onboard Kavach Overview</h2>
                    <p>The Kavach system is a comprehensive train safety mechanism with several key components. At its core is the Vital Computer, which interfaces with the locomotive and its subsystems. The system receives cab control inputs, including cab control and direction information. Two LP-OCIPs in the locomotive cabs display relevant information to the loco pilots. The train is equipped with multiple antennas: radio antennas for communication, GNSS/GSM antennas for synchronized timing, and RFID antennas for precise location tracking. Speed and distance are monitored by directional pulse generators. The Brake Interface Unit allows Kavach to control various brake systems. An Isolation switch enables or disables Kavach's control over brakes and traction cut-off. Manual Isolation cocks in the BP pipeline and MR line (for specific locomotive types) are monitored by micro switches. Together, these components form a sophisticated system designed to enhance train safety and operation. </p>
                    <br>
                    <br>
                    <br>                    
                    <h2 class="text-xl font-semibold mb-4">Features Of Onboard Kavach </h2>
                    <p>Kavach, the Indian Railway Automatic Train Protection System, is a comprehensive safety mechanism designed to enhance train operations. It prevents Signal Passing at Danger (SPAD) and mitigates its consequences, including potential collisions. The system enforces speed limits by automatically activating brakes if necessary. Kavach provides cab signaling, monitors various speed restrictions, and alerts loco pilots about upcoming level crossing gates with automatic whistling. It offers protection against head-on and rear-end collisions, as well as standstill and roll-away scenarios. The system can generate SOS signals during unusual stoppages in block sections and allows manual SOS activation. Overall, Kavach significantly improves train safety through its diverse range of functionalities. </p>
                    <br>
                    <br>
                    <br>
                    <h2 class="text-xl font-semibold mb-4">Working Of Onboard Kavach</h2>
                    <p>The Kavach system utilizes track-side RFID tags to gather vital track information and determine train direction. It receives movement authority, signal information, and speed restrictions from stationary Kavach units. Based on this data, onboard Kavach monitors targets and controls speed, applying brakes when necessary to maintain safe speeds. The system enforces ceiling speed limits with graduated brake applications for increasing speed violations. Kavach adapts its braking strategy based on train characteristics, which are input by the loco pilot at the start of each mission. The system's intelligent braking logic considers factors like train speed, track gradient, and distance to target. In emergency situations, Kavach applies maximum brakes to minimize potential impact. Additionally, it can stop a train using emergency brakes if a signal changes to danger after being passed. </p>                
                </div>
                <div id="abbreviations" class="tab-content">
                    <h2 class="text-xl font-semibold mb-4">Abbreviations</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Abbreviations content will be dynamically added here -->
                    </div>
                </div>
                <div id="operatingModes" class="tab-content">
                    <h2 class="text-xl font-semibold mb-4">Operating Modes</h2>
                    <!-- Operating modes content will be dynamically added here -->
                </div>
                <div id="procedures" class="tab-content">
                    <h2 class="text-xl font-semibold mb-4">Key Procedures</h2>
                    <!-- Procedures content will be dynamically added here -->
                </div>
                <div id="dosAndDonts" class="tab-content">
                    <h2 class="text-xl font-semibold mb-4">DOs and DON'Ts</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <h3 class="font-semibold mb-2 flex items-center">
                                <i data-lucide="cpu" class="mr-2"></i> DOs & DON'Ts
                            </h3>
                            <ul class="list-disc pl-5">
                                <!-- DOs content will be dynamically added here -->
                            </ul>
                        </div>
<!--                         <div>
                            <h3 class="font-semibold mb-2 flex items-center">
                                <i data-lucide="alert-triangle" class="mr-2"></i> DON'Ts
                            </h3>
                            <ul class="list-disc pl-5">
                                <!-- DON'Ts content will be dynamically added here -->
                            </ul>
                        </div> -->
                    </div>
                </div>
                <div id="quiz" class="tab-content">
                    <h2 class="text-xl font-semibold mb-4">Quiz</h2>
                    <div id="quizContent">
                        <!-- Quiz content will be dynamically added here -->
                    </div>
                    <button id="submitQuiz" class="bg-blue-500 text-white py-2 px-4 rounded mt-4">Submit Quiz</button>
                </div>
            </div>
        </div>
    <div class="footer-text">
        Centre of Excellence - Kavach
    </div>
    </div>
    <script>
        // Data
        const sections = {
            abbreviations: [
                  { term: "ABS", definition: "Automatic Block Signalling" },
                  { term: "AWS", definition: "Auxiliary Warning System" },
                  { term: "BIU", definition: "Brake Interface Unit" },
                  { term: "BP", definition: "Brake Pipe Pressure" },
                  { term: "CCB", definition: "Computer Controller Brake" },
                  { term: "CNFM", definition: "Confirm" },
                  { term: "CoE", definition: "Centre of Excellence" },
                  { term: "CRW", definition: "Cab Rear Wall" },
                  { term: "EB", definition: "Emergency Brake" },
                  { term: "EEV", definition: "Emergency Exhaust Valve" },
                  { term: "EM", definition: "Emergency Magnet Valve Isolation" },
                  { term: "EMU", definition: "Electric Multiple Unit" },
                  { term: "FS", definition: "Full Supervision mode" },
                  { term: "FSB", definition: "Full Service Brake" },
                  { term: "G&SR", definition: "General & Subsidiary Rules" },
                  { term: "IB", definition: "Intermediate Block Signal" },
                  { term: "IODU", definition: "Input Output Distribution Unit" },
                  { term: "IRAB", definition: "Indian Railway Air Brake" },
                  { term: "IR-ATP", definition: "Indian Railways – Automatic Train Protection System" },
                  { term: "IRU", definition: "Interface Relay Unit" },
                  { term: "IS", definition: "Isolation mode" },
                  { term: "LC Gate", definition: "Level Crossing Gate" },
                  { term: "LP", definition: "Loco Pilot" },
                  { term: "LP-OCIP", definition: "Loco Pilot - Operation cum Indication Panel/DMI" },
                  { term: "LS", definition: "Limited Supervision mode" },
                  { term: "MA", definition: "Movement Authority" },
                  { term: "MCB", definition: "Miniature Circuit Breaker" },
                  { term: "MR", definition: "Main Reservoir" },
                  { term: "NL", definition: "Non-Leading" },
                  { term: "NSB", definition: "Normal Service Brake" },
                  { term: "OEM", definition: "Original Equipment Manufacturer" },
                  { term: "OS", definition: "On-Sight mode" },
                  { term: "OSD", definition: "Officer on Special Duty" },
                  { term: "OV/OVRD", definition: "Override mode" },
                  { term: "PDU", definition: "Power Distribution Unit" },
                  { term: "PG", definition: "Pulse Generator" },
                  { term: "PRC", definition: "Power Controller" },
                  { term: "PSR", definition: "Permanent Speed Restriction" },
                  { term: "PT", definition: "Post Trip mode" },
                  { term: "RFID", definition: "Radio Frequency Identification" },
                  { term: "RV/REV", definition: "Reverse" },
                  { term: "SB", definition: "Service Brake and Standby mode" },
                  { term: "SH/SHNT", definition: "Shunt mode" },
                  { term: "SIFA Magnet Valve", definition: "Emergency Magnet Valve" },
                  { term: "SM-OCIP", definition: "Station Master - Operation cum Indication Panel" },
                  { term: "SoS", definition: "Save Our Soul" },
                  { term: "SPAD", definition: "Signal Passing At Danger" },
                  { term: "SR", definition: "Staff Responsible mode" },
                  { term: "TCAS", definition: "Train Collision Avoidance System" },
                  { term: "TIN", definition: "Track Identification Number" },
                  { term: "TLC", definition: "Traction Loco Controller" },
                  { term: "TRIP", definition: "Trip mode" },
                  { term: "T&RS", definition: "Traction & Rolling Stock" }
            ],
            operatingModes: [
                { title: "Standby Mode", content: "The Standby (SB) mode is the default state of the Kavach system when it's switched on or when the locomotive's reverser handle is in neutral. In this mode, the train cannot move, and Kavach performs standstill supervision, applying brakes if any speed is detected. The system conducts automatic self-tests and prompts the loco pilot to select train configuration. To exit Standby mode, the loco pilot must choose either Staff Responsible or Shunt mode based on operational needs. The loco pilot's responsibility is to observe the Standby mode after power-on, wait for successful self-tests, and respond to the configuration prompt on the LP-OCIP." },
                { title: "Staff Responsible (SR) Mode", content: "The Staff Responsible (SR) mode in Kavach is activated after self-tests and train configuration selection, requiring the loco pilot to confirm via the LP-OCIP. In this mode, Kavach supervises the locomotive's ceiling speed, prevents roll back and reverse movement, and guards against head-on and rear-end collisions. It also manages SOS generation and emergency stops when location data is available. The system automatically exits SR mode when conditions for Limited Supervision or Full Supervision modes are met. In SR mode, the loco pilot is responsible for train operation, with Kavach providing assistive supervision of the locomotive's ceiling speed." },
                { title: "Limited Supervision (LS) Mode", content: "In Limited Supervision (LS) mode, the Onboard Kavach system monitors loco speed, section speed, Permanent Speed Restrictions (PSR), and collision targets if track data and traffic direction are valid. It also ensures safety by supervising movement authority, turnout speed limits, and protecting against rollaways and reverse movements. The system automatically enters LS mode from Full Supervision (FS) mode when RFID tag data or station communication is incomplete, or during mission start until a stop signal is passed in the OFF condition. It exits LS mode and returns to FS mode when complete train and track data are available, or transitions to SR mode if both tag data and communication are lost. The loco pilot must acknowledge LP-OCIP messages to avoid automatic braking during transitions between modes." },
                { title: "Full Supervision (FS) Mode", content: "Full Supervision (FS) mode activates automatically when the Onboard Kavach receives complete communication from the station and consecutive RFID tag data, and the train passes a stop signal in OFF condition at mission start. In FS mode, Kavach supervises movement authority, turnout speeds, performs train length measurement, and adheres to loco-specific SoS from the linked station. It also displays crucial information such as train speed, permitted speed, target distance, and target speed on the LP-OCIP, and takes full responsibility for speed supervision. The system exits FS mode automatically to Limited Supervision (LS) if required data or communication is lost, to Trip mode if a signal is crossed in ON condition, or when the loco pilot manually selects Override, Shunt, or Reverse modes. The loco pilot must ensure control of the train within the permitted speed limits to avoid unintended braking by Kavach." },
                { title: "Override Mode", content: "Override (OV) mode is manually selected by the loco pilot through the LP-OCIP soft keys when there is a valid reason to bypass a signal in the ON condition, typically when the Movement Authority (MA) is less than 200 meters and the train is stationary. In this mode, Kavach displays the train speed and monitors movements against a ceiling override speed of 15 km/h, transitioning to Full Supervision (FS) mode if MA is extended or after an override timeout (240 seconds) with known section speed and traffic direction. It also obeys SoS from stationary TCAS and keeps radio transmission active within Kavach's area. The loco pilot must verify the track ahead for occupancy while in this mode and ensure proper authority is obtained to pass the signal at Danger. The system automatically exits OV mode to Onsite Mode (OS) when the train crosses the signal at ON." },
                { title: "On-sight Mode", content: "On-sight (OS) mode automatically activates when the Override (OV) mode is selected and the signal is crossed at ON. In OS mode, the Onboard Kavach allows the train to enter sections that may be occupied by other trains and supervises movements against a ceiling speed of 15 km/h. It also adheres to SOS from stationary TCAS. The system exits OS mode when the train passes specific signals, such as Last Stop Signals, Gate Signals, IB Home signals, or Auto signals, by the required distances (200m or 250m) or after crossing the next signal at an OFF aspect. The loco pilot must carefully check track occupancy as the track may be occupied while in this mode." },
                { title: "Trip Mode", content: "Trip (TR) mode activates when the Onboard Kavach is in Full Supervision or Limited Supervision mode and the train passes a stop signal at ON or the End of Authority plus 30 meters. This mode triggers the continuous application of emergency brakes to halt the train and performs standstill supervision while sending SOS signals until the trip is acknowledged. It can occur due to improper operation by the loco pilot, malfunctioning of Kavach, or signal issues with inadequate braking distance. The loco pilot must acknowledge the trip by pressing P_TRIP followed by CNFM on the LP-OCIP to release the emergency brakes. In case of Kavach malfunction, the loco pilot must isolate the system and only return it to service once it is confirmed safe." },
                { title: "Post Trip Mode", content: "Post-Trip (PT) mode is entered automatically after a train halts due to emergency braking in Trip Mode when the loco pilot selects it by pressing P_TRIP followed by CNFM on the LP-OCIP, which releases the emergency brake. In this mode, the Onboard Kavach supervises the train against a ceiling speed of 15 km/h. It exits PT mode automatically when valid Movement Authority (MA), section speed, and traffic direction are known, and the train either crosses a stop signal at OFF or travels a predefined distance of 250 meters. The loco pilot must select PT mode and confirm with CNFM to release the emergency brake and continue at the reduced speed." },
                { title: "Non Leading Mode", content: "Non-Leading (NL) mode is manually selected by the loco pilot via a rotary switch on the LP-OCIP when the train or loco is at a standstill. This mode is used for a slave engine, either electrically coupled or not coupled to the leading engine, and it disables active supervision by the Onboard Kavach while allowing periodic transmission of its status to the Kavach network. The loco pilot must change the rotary switch to Leading mode to exit NL mode. This mode should not be used in a single loco/train formation, as the Kavach will not provide train supervision or protection, placing the full responsibility for safety on the loco pilot." },
                { title: "Reverse Mode", content: "Reverse (RV) mode is manually activated by the loco pilot using the REV and CNFM soft keys on the LP-OCIP, and can only be selected when the loco is at a standstill. This mode allows the train to move in reverse while keeping the train orientation unchanged, with Kavach supervising against a ceiling speed of 15 km/h, a distance of 500 meters, and a time-out of 300 seconds. Kavach obeys SoS from stationary systems, but if the Track Identification Number (TIN) changes during reverse movement, it will generate a loco-specific SOS and apply the brakes. The system automatically exits RV mode when it detects forward movement. The loco pilot must select RV mode for pushback in emergency situations, as Kavach otherwise restricts reverse movement and ensures rollback protection." },
                { title: "Shunt Mode", content: "Shunt (SH) mode is manually selected by the loco pilot using the SHNT and CNFM soft keys on the LP-OCIP and can only be activated when the loco is at a standstill. In this mode, Kavach allows shunting operations at a restricted speed of 15 km/h and only responds to SOS signals from stationary Kavach systems. The loco pilot must manually exit SH mode by reselecting SHNT and CNFM while the train is stationary. The loco pilot is responsible for conducting shunting operations according to station working rules and relevant guidelines." },
                { title: "System Failure Mode", content: "System Failure (SF) mode automatically activates when there is a fault in the Onboard Kavach that impairs its functionality. In SF mode, Kavach continuously applies emergency brakes to halt the train. The system will recover from this mode automatically if the failure is fixable; otherwise, the loco pilot must isolate Kavach by switching to Isolation mode and closing the manual cocks. The loco pilot is responsible for isolating the system as outlined in SECTION#3(II) and operating the train under their own authority." },
                { title: "Isolation Mode", content: "Isolation (IS) mode is manually activated by the loco pilot using the Isolation switch and by closing the EM and MR cocks, if applicable. In this mode, the Onboard Kavach sends periodic status updates to the Network Monitoring System but does not supervise or protect the train. The loco pilot must manually exit IS mode by switching to Service mode and reopening the EM and MR cocks. This mode should only be used under extreme necessity, as the Kavach will not provide any train supervision or protection, placing full responsibility for the train's safety on the loco pilot." }
            ],
            procedures: [
                { title: "Procedure for Switching-On Onboard Kavach", content: "To start the Onboard Kavach system, first, energize the locomotive and develop the MR (above 7 kg/cm²) and BP (4.8 kg/cm²) pressures. Turn on the Kavach power MCB and ensure the Leading/Non-Leading switch on the LP-OCIP is set to Leading in both CABs or in the working CAB of EMUs, if available. Set the Kavach Isolation switch to NORMAL. Depending on the type of locomotive or EMU, adjust the MR and EM cocks as specified. Insert the BL or Reverser key to initiate the brake functional test; if successful, the system will prompt for train configuration. Choose the Staff Responsible (SR) or Shunt (SH) mode and press CNFM on the LP-OCIP to proceed. If the brake test fails, the Loco Pilot can retest or isolate the Kavach. Until SR or SH mode is selected, the system remains in Standby (SB) mode." },
                { title: "Procedure for Switching OFF Onboard Kavach", content: "To isolate the Onboard Kavach system, set the Kavach Isolation switch to ISOLATE. For different types of locomotives and EMUs, ensure the MR and EM cocks are in the OFF (Closed) position as specified: on IRAB and E-70, close both MR and EM cocks, and set the IRU Bypass Switch to Bypass; on CCB 2.0, close the EM cock; and for EMUs (Conventional, Three-Phase, and Vande Bharat Express), close the EM cock while adjusting the MR cock as directed. Finally, switch off the power MCB." },
                { title: "Procedure of Brakes Functional Test and Selection of Train Configuration ", content: "To activate the Onboard Kavach system, insert the BL key for electric locos or place the Reverser handle in the forward position for diesel locos. Ensure the Main Reservoir (MR) pressure is above 7.00 kg/cm² and the Brake Pipe (BP) pressure is above 4.8 kg/cm²; the Kavach will wait until these conditions are met. The system then performs an automatic brake test, applying Normal Service Brake (NSB), Full Service Brake (FSB), and Emergency Brake (EB) if the pressure requirements are fulfilled. After the brake test, the result will be displayed on the LP-OCIP; if the test fails, the Loco Pilot can retest by pressing the ACK button. The Onboard Kavach remains in Standby mode until the brake test is successful. Upon passing the test, the Loco Pilot must select the Train Configuration by pressing CONFIG followed by CNFM on the LP-OCIP, choosing the train type, and reconfirming the selection. For operations other than shunting, select Staff Responsible (SR) mode; for shunting, select Shunt (SHNT) mode. Once the mode is set, the Onboard Kavach is in Service, and the train can be operated normally. The Loco Pilot must update the Train Configuration whenever there is a formation change or at the start of a mission to ensure proper safe braking distance. This procedure applies to MEDHA and KERNEX systems, while HBL requires configuration followed by brake tests." },
                { title: "Procedure for SOS Generation and Reception:", content: "In an emergency, the Loco Pilot can generate a Manual SOS by simultaneously pressing the SOS and COMMON buttons on the LP-OCIP. If a train stops unexpectedly in a block section despite a clear line, the Onboard Kavach system will prompt the Loco Pilot for acknowledgment within 15 seconds; failure to do so will result in an automatic SOS broadcast and brake application. To cancel a broadcasted SOS message, the Loco Pilot must press the Acknowledge/Cancel and ‘Common’ buttons together. When an SOS is received, approaching trains within 3000 meters of the SOS origin must apply brakes and reduce speed to a maximum of 30 km/h until they pass the SOS source. Normal speed will be restored when the SOS message is canceled, the train is more than 1500 meters from the SOS source, or no SOS message is received from the source for over 3 minutes." },
                { title: "Collision Situations", content: "Onboard Kavach units, whether directly or via a Stationary Kavach unit, are designed to detect head-on and rear-end collisions based on track identification, train speed, location, length, and movement direction. For head-on collisions, if two trains on the same track are moving in opposite directions, both Onboard Kavach units apply brakes to stop the trains within a configurable distance (300 meters in a block section) and then withdraw the brakes once the situation is resolved. For rear-end collisions, if trains are moving in the same direction on the same track, only the rear train's Kavach unit applies brakes to stop it within a configurable distance (100 meters) from the train ahead, with no action taken by the front train. In station sections, Stationary Kavach units prevent collisions by detecting SPAD and TIN conflicts, issuing SOS commands if two trains are detected moving towards each other on the same TIN. Upon receiving these SOS commands, the Onboard Kavach units of both trains automatically apply brakes." },
                { title: "Train movement from Kavach section to non-Kavach section", content: "When an Onboard Kavach system detects a train moving from a Kavach-equipped section to a non-Kavach section, it reads the exit tag and transitions to Staff Responsible (SR) mode. The Loco Pilot must acknowledge this transition by pressing the ACK/Cancel button within 15 seconds (configurable). If the acknowledgment is not received within the time frame, the system will apply the brakes until the Loco Pilot acknowledges the transition." },
                { title: "Procedure for Shunting", content: "To activate Shunting mode, the Loco Pilot must press the SHNT and then CNFM soft keys on the LP-OCIP while the locomotive is stationary. During shunting, the Loco Pilot must adhere to station working rules and general/subsidiary rules. To exit Shunting mode, the Loco Pilot should repeat the activation process by pressing SHNT and CNFM on the LP-OCIP while the locomotive remains stationary." },
                { title: "PROCEDURE FOR Leading/NON-LEADING Switch OPERATION", content: "For single locomotives, ensure the Leading/Non-Leading switch on the LP-OCIP of both CABs is set to Leading when the train is at a standstill. In multiple-locomotive setups, the leading locomotive performs train supervision, so its Leading/Non-Leading switches should be set to Leading on both CABs. Trailing locomotives do not perform train supervision, so their switches should be set to Non-Leading on both CABs when at a standstill. It is crucial not to set the Leading/Non-Leading switch to Non-Leading in single loco/train formations, as this will disable train supervision and Kavach protection. If the switch is incorrectly set to Non-Leading, the Loco Pilot assumes full responsibility for the train's safety." },
                { title: "SPAD AND TRAIN TRIP RECOVERY", content: "When an Onboard Kavach system in Full or Limited Supervision mode passes a stop signal at ON or End of Authority plus 30 meters, it enters Trip Mode and applies the emergency brake continuously. After the train stops, the Loco Pilot must acknowledge by pressing the P_TRIP and CNFM soft keys on the LP-OCIP, causing the system to transition to Post Trip mode. In Post Trip mode, the emergency brake is released, and the system supervises train movements with a ceiling speed limit of 15 km/h." },
                { title: "Auto whistling on approach of Level Crossing Gate", content: "The Onboard Kavach system displays level crossing (LC) gate information on the LP-OCIP when approaching an LC gate, detected through LC gate tags. If the movement authority is less than the distance to the LC gate, the system will not activate the horn. Continuous whistling starts from 600 meters before the LC gate and continues until the train reaches the gate. The auto-whistling can be canceled by pressing the Ack/Cancel button on the LP-OCIP." }
            ],
            dosAndDonts: {
                dos: [
                    "Check equipment intactness before switching ON",
                    "Read and understand the user manual thoroughly",
                    "Acknowledge alerts on LP-OCIP immediately",
                    "Properly select train configuration and operating modes",
                    "Handle LP-OCIP with care",
                    "Inform TLC/PRC about any defects",
                    "Follow G&SR provisions and operational requirements",
                    "Ensure intactness of RFID readers",
                    "Don't attempt any repair work",
                    "Don't switch OFF power when system is functioning",
                    "Don't remove system modules or connectors when functioning",
                    "Don't isolate Onboard Kavach when Train is in movement"
                ],
                donts: [
                    "Don't attempt any repair work",
                    "Don't switch OFF power when system is functioning",
                    "Don't remove system modules or connectors when functioning",
                    "Don't isolate Onboard Kavach when Train is in movement"
                ]
            }
        };

        // Quiz data
        const quizQuestions = [
            {
                question: "Which of the the following are the objectives of KAVACH?",
                options: ["Protects against SPAD", "Protect against excess speed", "Protects against collision", "All of the above"],
                answer: "All of the above"
            },
            {
                question: "The Display provided in the LP cab is called",
                options: ["FDCS", "VCU", "DMI", "MEP"],
                answer: "DMI"
            },
            {
                question: "Full form of DMI is ?",
                options: ["Driver Machine Interface", "Driver Management interface", "Dual machine interface", "Driver multi interface"],
                answer: "Driver Machine Interface"
            },
            {
                question: "Which of the the following make of KAVACH available in the market?",
                options: ["KERNEX", "HBL", "MEDHA", "All of the above"],
                answer: "All of the above"
            },
            {
                question: "KAVACH also called----",
                options: ["TCMS", "TCAS", "TCKS", "None of the above"],
                answer: "TCAS"
            },
            {
                question: "To Pass the Signal at ON with proper authority, Kavach will operate in which mode?",
                options: ["SPAD mode", "Bypass mode", "Override mode", "SOS mode"],
                answer: "Override mode"
            }
        ];

        // Populate content
        document.addEventListener('DOMContentLoaded', () => {
            populateAbbreviations();
            populateOperatingModes();
            populateProcedures();
            populateDosAndDonts();
            setupTabNavigation();
            setupSearch();
            setupQuiz();
            lucide.createIcons();
        });

        function populateAbbreviations() {
            const container = document.querySelector('#abbreviations .grid');
            sections.abbreviations.forEach(item => {
                const div = document.createElement('div');
                div.className = 'flex items-start';
                div.innerHTML = `
                    <i data-lucide="radio" class="mr-2 mt-1"></i>
                    <div>
                        <span class="font-semibold">${item.term}:</span> ${item.definition}
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function populateOperatingModes() {
            const container = document.querySelector('#operatingModes');
            sections.operatingModes.forEach(item => {
                const div = document.createElement('div');
                div.className = 'mb-4';
                div.innerHTML = `
                    <div>
                        <span class="font-semibold">${item.title}:</span> ${item.content}
                    </div>  
                `;
                container.appendChild(div);
            });
        }

        function populateProcedures() {
            const container = document.querySelector('#procedures');
            sections.procedures.forEach(item => {
                const div = document.createElement('div');
                div.className = 'mb-4';
                div.innerHTML = `
                    <div>
                        <span class="font-semibold">${item.title}:</span> ${item.content}
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function populateDosAndDonts() {
            const dosContainer = document.querySelector('#dosAndDonts ul:first-of-type');
            const dontsContainer = document.querySelector('#dosAndDonts ul:last-of-type');
            
            sections.dosAndDonts.dos.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item;
                dosContainer.appendChild(li);
            });

            // sections.dosAndDonts.donts.forEach(item => {
            //     const li = document.createElement('li');
            //     li.textContent = item;
            //     dontsContainer.appendChild(li);
            // });
        }

        function setupTabNavigation() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', (e) => {
                    e.preventDefault();
                    // Remove active class from all tabs
                    tabs.forEach(t => t.classList.remove('active'));
                    
                    // Add active class to the clicked tab
                    tab.classList.add('active');
                    
                    // Hide all tab contents
                    const tabContent = document.querySelectorAll('.tab-content');
                    tabContent.forEach(content => content.classList.remove('active'));
                    
                    // Show the content of the clicked tab
                    document.getElementById(tab.dataset.tab).classList.add('active');
                });
            });

            // Set "Kavach Operation" to show Operating Modes content when clicked
            const kavachOperationTab = document.querySelector('.dropdown > .tab');
            kavachOperationTab.addEventListener('click', (e) => {
                e.preventDefault();
                // Remove active class from all tabs
                tabs.forEach(t => t.classList.remove('active'));
                
                // Add active class to the Kavach Operation tab
                kavachOperationTab.classList.add('active');
                
                // Hide all tab contents
                const tabContent = document.querySelectorAll('.tab-content');
                tabContent.forEach(content => content.classList.remove('active'));
                
                // Show the Operating Modes content
                document.getElementById('operatingModes').classList.add('active');
            });
        }
        
        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');
            const mainContent = document.getElementById('mainContent');
            const resultsContent = document.getElementById('resultsContent');

            searchInput.addEventListener('input', () => {
                const searchTerm = searchInput.value.toLowerCase();
                if (searchTerm.length > 0) {
                    const results = performSearch(searchTerm);
                    displaySearchResults(results);
                    searchResults.classList.remove('hidden');
                    mainContent.classList.add('hidden');
                } else {
                    searchResults.classList.add('hidden');
                    mainContent.classList.remove('hidden');
                }
            });
        }

        function performSearch(searchTerm) {
            const results = [];
            Object.entries(sections).forEach(([sectionKey, sectionContent]) => {
                if (Array.isArray(sectionContent)) {
                    sectionContent.forEach(item => {
                        if (JSON.stringify(item).toLowerCase().includes(searchTerm)) {
                            results.push({ section: sectionKey, content: item });
                        }
                    });
                } else if (typeof sectionContent === 'object') {
                    Object.entries(sectionContent).forEach(([subKey, subContent]) => {
                        subContent.forEach(item => {
                            if (item.toLowerCase().includes(searchTerm)) {
                                results.push({ section: `${sectionKey} - ${subKey}`, content: item });
                            }
                        });
                    });
                }
            });
            return results;
        }

        function displaySearchResults(results) {
            const resultsContent = document.getElementById('resultsContent');
            resultsContent.innerHTML = '';
            if (results.length > 0) {
                results.forEach(result => {
                    const div = document.createElement('div');
                    div.className = 'mb-4';
                    div.innerHTML = `
                        <h3 class="font-semibold">${result.section}</h3>
                        <p>${typeof result.content === 'string' ? result.content : JSON.stringify(result.content)}</p>
                    `;
                    resultsContent.appendChild(div);
                });
            } else {
                resultsContent.innerHTML = '<p>No results found</p>';
            }
        }

        function setupQuiz() {
            const quizContent = document.getElementById('quizContent');
            const randomQuestions = quizQuestions.sort(() => 0.5 - Math.random()).slice(0, 10);
            
            randomQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'mb-4';
                questionDiv.innerHTML = `
                    <p class="font-semibold">${index + 1}. ${q.question}</p>
                    <div>
                        ${q.options.map((option, i) => `
                            <label class="block">
                                <input type="radio" name="question${index}" value="${option}"> ${option}
                            </label>
                        `).join('')}
                    </div>
                `;
                quizContent.appendChild(questionDiv);
            });

            document.getElementById('submitQuiz').addEventListener('click', () => {
                let score = 0;
                randomQuestions.forEach((q, index) => {
                    const selectedOption = document.querySelector(`input[name="question${index}"]:checked`);
                    if (selectedOption && selectedOption.value === q.answer) {
                        score += 1;
                    }
                });
                alert(`You scored ${score} out of ${randomQuestions.length}`);
            });
        }
    </script>
</body>
</html>
