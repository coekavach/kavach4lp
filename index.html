<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>e-Operating Manual for Loco Pilots</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.415.0/lucide.min.js"></script>
    <style>
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .tab.active {
            background-color: #f0f9ff;
            border-bottom: 2px solid #1d4ed8;
            color: #1d4ed8;
        }
        .footer-text {
            position: fixed;
            bottom: 0;
            right: 0;
            margin: 16px;
            font-style: italic;
            color: grey;
        }
        .dropdown {
            position: relative;
            display: inline-block;
        }
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
        }
        .dropdown:hover .dropdown-content {
            display: block;
        }
        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }
        .dropdown-content a:hover {
            background-color: #f1f1f1;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-4">
        <h1 class="text-4xl font-bold mb-12 text-center mx-auto text-blue-700">
            e-Operating Manual for Loco Pilots
            <br>
            <span class="text-3xl italic text-blue-700 font-normal">
                Kavach Spec Ver 3.2
            </span>
        </h1>
        <div class="mb-8 flex justify-center items-center">
            <input type="text" id="searchInput" placeholder="Search..." class="border-2 border-blue-500 rounded-lg p-2 text-lg shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full max-w-md">
            <i data-lucide="search" class="text-gray-500 ml-3 text-lg"></i>
        </div>
        <div id="searchResults" class="bg-white shadow-md rounded p-4 hidden">
            <h2 class="text-xl font-semibold mb-4">Search Results</h2>
            <div id="resultsContent"></div>
        </div>
        <div id="mainContent">
            <div class="mb-4">
                <div class="flex flex-wrap border-b">
                    <button class="tab py-2 px-4" data-tab="overview">Overview</button>
                    <button class="tab py-2 px-4" data-tab="abbreviations">Abbreviations</button>
                    <div class="dropdown">
                        <button class="tab py-2 px-4" data-tab="operatingModes">Kavach Operation</button>
                        <div class="dropdown-content">
                            <a href="#" class="tab" data-tab="operatingModes">Operating Modes</a>
                            <a href="#" class="tab" data-tab="procedures">Key Procedures</a>
                            <a href="#" class="tab" data-tab="dosAndDonts">DOs and DON'Ts</a>
                        </div>
                    </div>
                    <button class="tab py-2 px-4" data-tab="quiz">Take Quiz</button>
                </div>
            </div>
            <div class="bg-white shadow-md rounded p-4">
                <div id="overview" class="tab-content active">
                    <h2 class="text-xl font-semibold mb-4">Overview</h2>
                    <p>The Kavach system is an Automatic Train Protection system used in Indian Railways. This dashboard provides key information from the operation manual, including abbreviations, operating modes, procedures, and safety guidelines.</p>
                </div>
                <div id="abbreviations" class="tab-content">
                    <h2 class="text-xl font-semibold mb-4">Abbreviations</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Abbreviations content will be dynamically added here -->
                    </div>
                </div>
                <div id="operatingModes" class="tab-content">
                    <h2 class="text-xl font-semibold mb-4">Operating Modes</h2>
                    <!-- Operating modes content will be dynamically added here -->
                </div>
                <div id="procedures" class="tab-content">
                    <h2 class="text-xl font-semibold mb-4">Key Procedures</h2>
                    <!-- Procedures content will be dynamically added here -->
                </div>
                <div id="dosAndDonts" class="tab-content">
                    <h2 class="text-xl font-semibold mb-4">DOs and DON'Ts</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <h3 class="font-semibold mb-2 flex items-center">
                                <i data-lucide="cpu" class="mr-2"></i> DOs
                            </h3>
                            <ul class="list-disc pl-5">
                                <!-- DOs content will be dynamically added here -->
                            </ul>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-2 flex items-center">
                                <i data-lucide="alert-triangle" class="mr-2"></i> DON'Ts
                            </h3>
                            <ul class="list-disc pl-5">
                                <!-- DON'Ts content will be dynamically added here -->
                            </ul>
                        </div>
                    </div>
                </div>
                <div id="quiz" class="tab-content">
                    <h2 class="text-xl font-semibold mb-4">Quiz</h2>
                    <div id="quizContent">
                        <!-- Quiz content will be dynamically added here -->
                    </div>
                    <button id="submitQuiz" class="bg-blue-500 text-white py-2 px-4 rounded mt-4">Submit Quiz</button>
                </div>
            </div>
        </div>
    <div class="footer-text">
        Centre of Excellence - Kavach
    </div>
    </div>
    <script>
        // Data
        const sections = {
            abbreviations: [
                  { term: "ABS", definition: "Automatic Block Signalling" },
                  { term: "AWS", definition: "Auxiliary Warning System" },
                  { term: "BIU", definition: "Brake Interface Unit" },
                  { term: "BP", definition: "Brake Pipe Pressure" },
                  { term: "CCB", definition: "Computer Controller Brake" },
                  { term: "CNFM", definition: "Confirm" },
                  { term: "CoE", definition: "Centre of Excellence" },
                  { term: "CRW", definition: "Cab Rear Wall" },
                  { term: "EB", definition: "Emergency Brake" },
                  { term: "EEV", definition: "Emergency Exhaust Valve" },
                  { term: "EM", definition: "Emergency Magnet Valve Isolation" },
                  { term: "EMU", definition: "Electric Multiple Unit" },
                  { term: "FS", definition: "Full Supervision mode" },
                  { term: "FSB", definition: "Full Service Brake" },
                  { term: "G&SR", definition: "General & Subsidiary Rules" },
                  { term: "IB", definition: "Intermediate Block Signal" },
                  { term: "IODU", definition: "Input Output Distribution Unit" },
                  { term: "IRAB", definition: "Indian Railway Air Brake" },
                  { term: "IR-ATP", definition: "Indian Railways â€“ Automatic Train Protection System" },
                  { term: "IRU", definition: "Interface Relay Unit" },
                  { term: "IS", definition: "Isolation mode" },
                  { term: "LC Gate", definition: "Level Crossing Gate" },
                  { term: "LP", definition: "Loco Pilot" },
                  { term: "LP-OCIP", definition: "Loco Pilot - Operation cum Indication Panel/DMI" },
                  { term: "LS", definition: "Limited Supervision mode" },
                  { term: "MA", definition: "Movement Authority" },
                  { term: "MCB", definition: "Miniature Circuit Breaker" },
                  { term: "MR", definition: "Main Reservoir" },
                  { term: "NL", definition: "Non-Leading" },
                  { term: "NSB", definition: "Normal Service Brake" },
                  { term: "OEM", definition: "Original Equipment Manufacturer" },
                  { term: "OS", definition: "On-Sight mode" },
                  { term: "OSD", definition: "Officer on Special Duty" },
                  { term: "OV/OVRD", definition: "Override mode" },
                  { term: "PDU", definition: "Power Distribution Unit" },
                  { term: "PG", definition: "Pulse Generator" },
                  { term: "PRC", definition: "Power Controller" },
                  { term: "PSR", definition: "Permanent Speed Restriction" },
                  { term: "PT", definition: "Post Trip mode" },
                  { term: "RFID", definition: "Radio Frequency Identification" },
                  { term: "RV/REV", definition: "Reverse" },
                  { term: "SB", definition: "Service Brake and Standby mode" },
                  { term: "SH/SHNT", definition: "Shunt mode" },
                  { term: "SIFA Magnet Valve", definition: "Emergency Magnet Valve" },
                  { term: "SM-OCIP", definition: "Station Master - Operation cum Indication Panel" },
                  { term: "SoS", definition: "Save Our Soul" },
                  { term: "SPAD", definition: "Signal Passing At Danger" },
                  { term: "SR", definition: "Staff Responsible mode" },
                  { term: "TCAS", definition: "Train Collision Avoidance System" },
                  { term: "TIN", definition: "Track Identification Number" },
                  { term: "TLC", definition: "Traction Loco Controller" },
                  { term: "TRIP", definition: "Trip mode" },
                  { term: "T&RS", definition: "Traction & Rolling Stock" }
            ],
            operatingModes: [
                { title: "Standby Mode", content: "Initial mode after power-on until mode selection." },
                { title: "Staff Responsible (SR) Mode", content: "Used for normal train operation when Kavach is active." },
                { title: "Limited Supervision (LS) Mode", content: "Used when some trackside equipment is not available." },
                { title: "Full Supervision (FS) Mode", content: "Provides full protection based on Movement Authority." },
                { title: "Override Mode", content: "Allows passing a signal at danger with speed restriction." },
                { title: "On-sight Mode", content: "Used for moving with caution in specific situations." },
                { title: "Trip Mode", content: "Activated when train passes a stop signal at ON. Emergency brake is applied." },
                { title: "Post Trip Mode", content: "Entered after acknowledging Trip Mode. Allows movement with speed limit." },
                { title: "Non Leading Mode", content: "Used for locomotives not leading the train." },
                { title: "Reverse Mode", content: "For reverse movement of the train." },
                { title: "Shunt Mode", content: "Used for shunting operations." },
                { title: "System Failure Mode", content: "Activated when critical faults are detected." },
                { title: "Isolation Mode", content: "Used when Kavach system needs to be isolated." }
            ],
            procedures: [
                { title: "Switching On Onboard Kavach", content: "1. Switch on Kavach power MCB. 2. Ensure Leading/Non Leading switch in 'Leading Position'. 3. Keep Kavach Isolation switch on NORMAL position. 4. Keep MR cock and EM cock in ON position. 5. Insert BL key or Reverser key. 6. Perform brake test and select train configuration." },
                { title: "Switching Off Onboard Kavach", content: "1. Keep Kavach Isolation switch on ISOLATE position. 2. Keep MR cock and EM cock in OFF position. 3. Switch OFF power MCB." },
                { title: "Brake Functional Test", content: "1. Ensure MR pressure > 7.00 kg/cm2 and BP pressure > 4.8 kg/cm2. 2. Onboard Kavach performs automatic brake test (NSB, FSB, EB). 3. Select Train Configuration after successful brake test." },
                { title: "SOS Procedure", content: "To generate Manual SOS: Press 'SOS' and 'COMMON' on LP-OCIP simultaneously. For Unusual Stoppage SOS: Acknowledge within 15 seconds when prompted." },
                { title: "Collision Prevention", content: "Kavach detects and prevents head-on collisions and rear-end collisions by automatically applying brakes when trains are on collision course." },
                { title: "SPAD Recovery", content: "When SPAD occurs, Kavach enters Trip Mode. Once stopped, LP must acknowledge to enter Post Trip Mode, allowing movement with speed restriction." }
            ],
            dosAndDonts: {
                dos: [
                    "Check equipment intactness before switching ON",
                    "Read and understand the user manual thoroughly",
                    "Acknowledge alerts on LP-OCIP immediately",
                    "Properly select train configuration and operating modes",
                    "Handle LP-OCIP with care",
                    "Inform TLC/PRC about any defects",
                    "Follow G&SR provisions and operational requirements",
                    "Ensure intactness of RFID readers","Don't attempt any repair work",
                    "Don't switch OFF power when system is functioning",
                    "Don't remove system modules or connectors when functioning",
                    "Don't isolate Onboard Kavach when Train is in movement"
                ]
            }
        };

        // Quiz data
        const quizQuestions = [
            {
                question: "Which of the the following are the objectives of KAVACH?",
                options: ["Protects against SPAD", "Protect against excess speed", "Protects against collision", "All of the above"],
                answer: "All of the above"
            },
            {
                question: "The Display provided in the LP cab is called",
                options: ["FDCS", "VCU", "DMI", "MEP"],
                answer: "DMI"
            },
            {
                question: "Full form of DMI is ?",
                options: ["Driver Machine Interface", "Driver Management interface", "Dual machine interface", "Driver multi interface"],
                answer: "Driver Machine Interface"
            },
            {
                question: "Which of the the following make of KAVACH available in the market?",
                options: ["KERNEX", "HBL", "MEDHA", "All of the above"],
                answer: "All of the above"
            },
            {
                question: "KAVACH also called----",
                options: ["TCMS", "TCAS", "TCKS", "None of the above"],
                answer: "TCAS"
            },
            {
                question: "To Pass the Signal at ON with proper authority, Kavach will operate in which mode?",
                options: ["SPAD mode", "Bypass mode", "Override mode", "SOS mode"],
                answer: "Override mode"
            }
        ];

        // Populate content
        document.addEventListener('DOMContentLoaded', () => {
            populateAbbreviations();
            populateOperatingModes();
            populateProcedures();
            populateDosAndDonts();
            setupTabNavigation();
            setupSearch();
            setupQuiz();
            lucide.createIcons();
        });

        function populateAbbreviations() {
            const container = document.querySelector('#abbreviations .grid');
            sections.abbreviations.forEach(item => {
                const div = document.createElement('div');
                div.className = 'flex items-start';
                div.innerHTML = `
                    <i data-lucide="radio" class="mr-2 mt-1"></i>
                    <div>
                        <span class="font-semibold">${item.term}:</span> ${item.definition}
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function populateOperatingModes() {
            const container = document.querySelector('#operatingModes');
            sections.operatingModes.forEach(item => {
                const div = document.createElement('div');
                div.className = 'mb-4';
                div.innerHTML = `
                    <div>
                        <span class="font-semibold">${item.title}:</span> ${item.content}
                    </div>  
                `;
                container.appendChild(div);
            });
        }

        function populateProcedures() {
            const container = document.querySelector('#procedures');
            sections.procedures.forEach(item => {
                const div = document.createElement('div');
                div.className = 'mb-4';
                div.innerHTML = `
                    <h3 class="font-semibold mb-2 flex items-center">
                        <i data-lucide="settings" class="mr-2"></i> ${item.title}
                    </h3>
                    <p>${item.content}</p>
                `;
                container.appendChild(div);
            });
        }

        function populateDosAndDonts() {
            const dosContainer = document.querySelector('#dosAndDonts ul:first-of-type');
            const dontsContainer = document.querySelector('#dosAndDonts ul:last-of-type');
            
            sections.dosAndDonts.dos.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item;
                dosContainer.appendChild(li);
            });

            sections.dosAndDonts.donts.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item;
                dontsContainer.appendChild(li);
            });
        }

        function setupTabNavigation() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', (e) => {
                    e.preventDefault();
                    // Remove active class from all tabs
                    tabs.forEach(t => t.classList.remove('active'));
                    
                    // Add active class to the clicked tab
                    tab.classList.add('active');
                    
                    // Hide all tab contents
                    const tabContent = document.querySelectorAll('.tab-content');
                    tabContent.forEach(content => content.classList.remove('active'));
                    
                    // Show the content of the clicked tab
                    document.getElementById(tab.dataset.tab).classList.add('active');
                });
            });

            // Set "Kavach Operation" to show Operating Modes content when clicked
            const kavachOperationTab = document.querySelector('.dropdown > .tab');
            kavachOperationTab.addEventListener('click', (e) => {
                e.preventDefault();
                // Remove active class from all tabs
                tabs.forEach(t => t.classList.remove('active'));
                
                // Add active class to the Kavach Operation tab
                kavachOperationTab.classList.add('active');
                
                // Hide all tab contents
                const tabContent = document.querySelectorAll('.tab-content');
                tabContent.forEach(content => content.classList.remove('active'));
                
                // Show the Operating Modes content
                document.getElementById('operatingModes').classList.add('active');
            });
        }
        
        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');
            const mainContent = document.getElementById('mainContent');
            const resultsContent = document.getElementById('resultsContent');

            searchInput.addEventListener('input', () => {
                const searchTerm = searchInput.value.toLowerCase();
                if (searchTerm.length > 0) {
                    const results = performSearch(searchTerm);
                    displaySearchResults(results);
                    searchResults.classList.remove('hidden');
                    mainContent.classList.add('hidden');
                } else {
                    searchResults.classList.add('hidden');
                    mainContent.classList.remove('hidden');
                }
            });
        }

        function performSearch(searchTerm) {
            const results = [];
            Object.entries(sections).forEach(([sectionKey, sectionContent]) => {
                if (Array.isArray(sectionContent)) {
                    sectionContent.forEach(item => {
                        if (JSON.stringify(item).toLowerCase().includes(searchTerm)) {
                            results.push({ section: sectionKey, content: item });
                        }
                    });
                } else if (typeof sectionContent === 'object') {
                    Object.entries(sectionContent).forEach(([subKey, subContent]) => {
                        subContent.forEach(item => {
                            if (item.toLowerCase().includes(searchTerm)) {
                                results.push({ section: `${sectionKey} - ${subKey}`, content: item });
                            }
                        });
                    });
                }
            });
            return results;
        }

        function displaySearchResults(results) {
            const resultsContent = document.getElementById('resultsContent');
            resultsContent.innerHTML = '';
            if (results.length > 0) {
                results.forEach(result => {
                    const div = document.createElement('div');
                    div.className = 'mb-4';
                    div.innerHTML = `
                        <h3 class="font-semibold">${result.section}</h3>
                        <p>${typeof result.content === 'string' ? result.content : JSON.stringify(result.content)}</p>
                    `;
                    resultsContent.appendChild(div);
                });
            } else {
                resultsContent.innerHTML = '<p>No results found</p>';
            }
        }

        function setupQuiz() {
            const quizContent = document.getElementById('quizContent');
            const randomQuestions = quizQuestions.sort(() => 0.5 - Math.random()).slice(0, 10);
            
            randomQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'mb-4';
                questionDiv.innerHTML = `
                    <p class="font-semibold">${index + 1}. ${q.question}</p>
                    <div>
                        ${q.options.map((option, i) => `
                            <label class="block">
                                <input type="radio" name="question${index}" value="${option}"> ${option}
                            </label>
                        `).join('')}
                    </div>
                `;
                quizContent.appendChild(questionDiv);
            });

            document.getElementById('submitQuiz').addEventListener('click', () => {
                let score = 0;
                randomQuestions.forEach((q, index) => {
                    const selectedOption = document.querySelector(`input[name="question${index}"]:checked`);
                    if (selectedOption && selectedOption.value === q.answer) {
                        score += 1;
                    }
                });
                alert(`You scored ${score} out of ${randomQuestions.length}`);
            });
        }
    </script>
</body>
</html>
